import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card'
import axios from '@/lib/axios'
import { Dashboard } from '@/models/types'
import { CalendarPicker } from './_components/CalendarPicker'

export async function generateMetadata() {
  return {
    title: 'Admin Dashboard | Sneakers Store',
  }
}

export default async function AdminPage({
  searchParams,
}: {
  searchParams: { [key: string]: string | string[] | undefined }
}) {
  const dashboard: Dashboard = await axios
    .get('/api/dashboard', {
      params: {
        startDate: searchParams.startDate || new Date(2024, 0, 1),
        endDate: searchParams.endDate || new Date(2024, 11, 31),
      },
    })
    .then((res) => res.data)
    .catch(() => null)

  return (
    <div className="flex flex-col gap-6">
      <div className="flex items-center justify-between space-y-2">
        <h2 className="text-3xl font-bold tracking-tight">Dashboard</h2>
        <CalendarPicker />
      </div>
      <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-4">
        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <CardTitle className="text-sm font-medium">Total Revenue</CardTitle>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              strokeLinecap="round"
              strokeLinejoin="round"
              strokeWidth="2"
              className="size-4 text-muted-foreground"
            >
              <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" />
            </svg>
          </CardHeader>
          <CardContent>
            <div className="text-2xl font-bold">{dashboard.revenue} €</div>
            <p className="text-xs text-muted-foreground">+{dashboard.revenueInRange} €</p>
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <CardTitle className="text-sm font-medium">Orders</CardTitle>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              strokeLinecap="round"
              strokeLinejoin="round"
              strokeWidth="2"
              className="size-4 text-muted-foreground"
            >
              <rect width="20" height="14" x="2" y="5" rx="2" />
              <path d="M2 10h20" />
            </svg>
          </CardHeader>
          <CardContent>
            <div className="text-2xl font-bold">{dashboard.orders}</div>
            <p className="text-xs text-muted-foreground">+{dashboard.ordersInRange}</p>
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <CardTitle className="text-sm font-medium">Products</CardTitle>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="200"
              height="200"
              fill="#000"
              version="1.1"
              viewBox="0 0 503.872 503.872"
              xmlSpace="preserve"
              className="size-6 text-muted-foreground"
            >
              <g>
                <path d="M503.872 324.488c0-23.875-13.649-40.873-33.694-48.502l-2.455-.934-1.887-.717c-21.201-8.058-30.716-11.863-42.14-17.116-13.949-6.416-25.143-11.454-33.357-14.95-6.638-2.837-11.183-4.605-13.85-5.336l-.039-.011c-.159-.043-.317-.086-.463-.121-.192-.048-.373-.09-.538-.124l-.022-.005c-1.478-.297-11.549-6.036-25.899-14.563l.538-.538a8.393 8.393 0 000-11.87 8.393 8.393 0 00-11.87 0l-3.515 3.515a4359.728 4359.728 0 01-21.783-13.231l1.627-1.627a8.393 8.393 0 000-11.87 8.393 8.393 0 00-11.87 0l-4.47 4.47a5233.767 5233.767 0 01-16.45-10.17l1.446-1.446a8.393 8.393 0 000-11.87 8.393 8.393 0 00-11.87 0l-4.2 4.2-1.133-.71c-2.683-1.681-5.308-3.33-7.85-4.933l-.174-.11-.134-.084a2797.94 2797.94 0 01-5.13-3.242l-1.249-.792c-14.285-9.059-25.229-16.201-29.277-19.239a25.146 25.146 0 00-3.833-2.372c-5.751-2.88-12.431-3.444-19.658-2.192-5.99 1.038-12.149 3.28-18.334 6.356-4.632 2.304-8.396 4.601-10.897 6.325-.222.153-.45.309-.652.452l-.04.033a422.073 422.073 0 01-12.659 10.133 8.52 8.52 0 00-.82.719c-44.57 34.332-70.066 37.51-82.794 24.83-1.961-1.953-3.156-3.854-3.691-5.033-2.943-17.566-8.279-27.66-17.168-30.69-7.037-2.399-13.394.238-19.029 5.316-2.179 1.964-3.815 3.897-4.851 5.349C-4.019 214.446-6.087 264.747 9.355 308.28c1.661 4.683 3.333 8.731 4.896 12.116-3.426 3.074-5.595 7.521-5.595 12.485v16.779c0 9.276 7.516 16.787 16.787 16.787l426.395.008c7.423.274 16.066-.598 24.625-3.633 16.668-5.911 27.293-18.532 27.406-38.278 0-.019.003-.037.003-.056zm-117.889-65.812c-10.829 15.725-32.234 20.257-48.553 10.011L175.732 167.155c1.064-.875 2.134-1.76 3.211-2.664l.109-.09c-.119.117.73-.451 1.948-1.21a82.639 82.639 0 016.812-3.804c4.85-2.412 9.557-4.125 13.733-4.847 3.543-.613 6.393-.472 8.579.373.727.281 1.38.64 1.96 1.076 4.531 3.399 15.682 10.718 30.107 19.885 4.005 2.545 8.26 5.231 12.7 8.018l-8.761 8.761c-3.278 3.278-3.278 8.592 0 11.87s8.592 3.278 11.87 0l11.508-11.508a4005.332 4005.332 0 0016.458 10.163l-6.259 6.259a8.393 8.393 0 000 11.87 8.393 8.393 0 0011.87 0l9.121-9.121a3417.643 3417.643 0 0021.834 13.18l-9.257 9.257a8.393 8.393 0 000 11.87 8.393 8.393 0 0011.87 0l12.285-12.285c17.376 10.219 30.552 17.585 34.182 18.783.202.067.374.115.516.143.021.004.051.013.073.018 1.303.295 6.342 2.312 13.782 5.524zM41.759 170.997c.03.002.926-1.058 2.068-2.087 1.583-1.427 2.565-1.834 2.375-1.898 1.386.472 4.141 5.807 6.158 18.367l.357 1.42c1.144 3.296 3.609 7.654 7.912 11.94 19.285 19.212 52.339 15.704 101.065-20.577l166.808 104.741c24.606 15.449 57.082 8.022 72.541-16.585l.475-.758c4.684 2.111 9.772 4.429 15.162 6.908 11.882 5.464 21.636 9.364 43.19 17.556l1.885.717 2.449.932c11.406 4.341 19.468 12.592 22.019 24.42H117.268c.327-2.793.503-5.591.503-8.393 0-41.718-33.823-75.541-75.541-75.541a74.914 74.914 0 00-24.235 4.017c2.749-20.948 10.281-42.803 23.764-65.179zM30.843 316.079a113.552 113.552 0 01-2.885-6.26l-.061-.143a123.352 123.352 0 01-1.587-3.956c-.289-.754-.574-1.524-.856-2.306-.09-.25-.182-.495-.271-.748-5.123-14.458-8.164-30.593-8.119-48.011a58.228 58.228 0 0125.167-5.709c32.447 0 58.754 26.307 58.754 58.754 0 2.786-.216 5.582-.642 8.393H30.85l-.007-.014zM470.852 347c-6.228 2.209-12.923 2.884-18.144 2.699-.339-.014-427.265-.04-427.265-.04V332.88h460.44c-2.187 6.974-7.319 11.385-15.031 14.12z"></path>
                <path d="M193.312 290.914c22.585 0 41.967-9.69 41.967-25.18 0-15.491-19.382-25.18-41.967-25.18s-41.967 9.69-41.967 25.18 19.382 25.18 41.967 25.18zm-19.987-29.544c5.024-2.512 12.204-4.03 19.987-4.03s14.962 1.518 19.987 4.03c3.706 1.853 5.194 3.611 5.194 4.364 0 .753-1.487 2.511-5.194 4.364-5.024 2.512-12.204 4.03-19.987 4.03s-14.962-1.518-19.987-4.03c-3.706-1.853-5.194-3.611-5.194-4.364.001-.753 1.488-2.512 5.194-4.364z"></path>
              </g>
            </svg>
          </CardHeader>
          <CardContent>
            <div className="text-2xl font-bold">{dashboard.products}</div>
            <p className="text-xs text-muted-foreground">+{dashboard.productsInRange}</p>
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <CardTitle className="text-sm font-medium">Product Variants</CardTitle>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="200"
              height="200"
              fill="#000"
              version="1.1"
              viewBox="0 0 503.872 503.872"
              xmlSpace="preserve"
              className="size-6 text-muted-foreground"
            >
              <g>
                <path d="M503.872 324.488c0-23.875-13.649-40.873-33.694-48.502l-2.455-.934-1.887-.717c-21.201-8.058-30.716-11.863-42.14-17.116-13.949-6.416-25.143-11.454-33.357-14.95-6.638-2.837-11.183-4.605-13.85-5.336l-.039-.011c-.159-.043-.317-.086-.463-.121-.192-.048-.373-.09-.538-.124l-.022-.005c-1.478-.297-11.549-6.036-25.899-14.563l.538-.538a8.393 8.393 0 000-11.87 8.393 8.393 0 00-11.87 0l-3.515 3.515a4359.728 4359.728 0 01-21.783-13.231l1.627-1.627a8.393 8.393 0 000-11.87 8.393 8.393 0 00-11.87 0l-4.47 4.47a5233.767 5233.767 0 01-16.45-10.17l1.446-1.446a8.393 8.393 0 000-11.87 8.393 8.393 0 00-11.87 0l-4.2 4.2-1.133-.71c-2.683-1.681-5.308-3.33-7.85-4.933l-.174-.11-.134-.084a2797.94 2797.94 0 01-5.13-3.242l-1.249-.792c-14.285-9.059-25.229-16.201-29.277-19.239a25.146 25.146 0 00-3.833-2.372c-5.751-2.88-12.431-3.444-19.658-2.192-5.99 1.038-12.149 3.28-18.334 6.356-4.632 2.304-8.396 4.601-10.897 6.325-.222.153-.45.309-.652.452l-.04.033a422.073 422.073 0 01-12.659 10.133 8.52 8.52 0 00-.82.719c-44.57 34.332-70.066 37.51-82.794 24.83-1.961-1.953-3.156-3.854-3.691-5.033-2.943-17.566-8.279-27.66-17.168-30.69-7.037-2.399-13.394.238-19.029 5.316-2.179 1.964-3.815 3.897-4.851 5.349C-4.019 214.446-6.087 264.747 9.355 308.28c1.661 4.683 3.333 8.731 4.896 12.116-3.426 3.074-5.595 7.521-5.595 12.485v16.779c0 9.276 7.516 16.787 16.787 16.787l426.395.008c7.423.274 16.066-.598 24.625-3.633 16.668-5.911 27.293-18.532 27.406-38.278 0-.019.003-.037.003-.056zm-117.889-65.812c-10.829 15.725-32.234 20.257-48.553 10.011L175.732 167.155c1.064-.875 2.134-1.76 3.211-2.664l.109-.09c-.119.117.73-.451 1.948-1.21a82.639 82.639 0 016.812-3.804c4.85-2.412 9.557-4.125 13.733-4.847 3.543-.613 6.393-.472 8.579.373.727.281 1.38.64 1.96 1.076 4.531 3.399 15.682 10.718 30.107 19.885 4.005 2.545 8.26 5.231 12.7 8.018l-8.761 8.761c-3.278 3.278-3.278 8.592 0 11.87s8.592 3.278 11.87 0l11.508-11.508a4005.332 4005.332 0 0016.458 10.163l-6.259 6.259a8.393 8.393 0 000 11.87 8.393 8.393 0 0011.87 0l9.121-9.121a3417.643 3417.643 0 0021.834 13.18l-9.257 9.257a8.393 8.393 0 000 11.87 8.393 8.393 0 0011.87 0l12.285-12.285c17.376 10.219 30.552 17.585 34.182 18.783.202.067.374.115.516.143.021.004.051.013.073.018 1.303.295 6.342 2.312 13.782 5.524zM41.759 170.997c.03.002.926-1.058 2.068-2.087 1.583-1.427 2.565-1.834 2.375-1.898 1.386.472 4.141 5.807 6.158 18.367l.357 1.42c1.144 3.296 3.609 7.654 7.912 11.94 19.285 19.212 52.339 15.704 101.065-20.577l166.808 104.741c24.606 15.449 57.082 8.022 72.541-16.585l.475-.758c4.684 2.111 9.772 4.429 15.162 6.908 11.882 5.464 21.636 9.364 43.19 17.556l1.885.717 2.449.932c11.406 4.341 19.468 12.592 22.019 24.42H117.268c.327-2.793.503-5.591.503-8.393 0-41.718-33.823-75.541-75.541-75.541a74.914 74.914 0 00-24.235 4.017c2.749-20.948 10.281-42.803 23.764-65.179zM30.843 316.079a113.552 113.552 0 01-2.885-6.26l-.061-.143a123.352 123.352 0 01-1.587-3.956c-.289-.754-.574-1.524-.856-2.306-.09-.25-.182-.495-.271-.748-5.123-14.458-8.164-30.593-8.119-48.011a58.228 58.228 0 0125.167-5.709c32.447 0 58.754 26.307 58.754 58.754 0 2.786-.216 5.582-.642 8.393H30.85l-.007-.014zM470.852 347c-6.228 2.209-12.923 2.884-18.144 2.699-.339-.014-427.265-.04-427.265-.04V332.88h460.44c-2.187 6.974-7.319 11.385-15.031 14.12z"></path>
                <path d="M193.312 290.914c22.585 0 41.967-9.69 41.967-25.18 0-15.491-19.382-25.18-41.967-25.18s-41.967 9.69-41.967 25.18 19.382 25.18 41.967 25.18zm-19.987-29.544c5.024-2.512 12.204-4.03 19.987-4.03s14.962 1.518 19.987 4.03c3.706 1.853 5.194 3.611 5.194 4.364 0 .753-1.487 2.511-5.194 4.364-5.024 2.512-12.204 4.03-19.987 4.03s-14.962-1.518-19.987-4.03c-3.706-1.853-5.194-3.611-5.194-4.364.001-.753 1.488-2.512 5.194-4.364z"></path>
              </g>
            </svg>
          </CardHeader>
          <CardContent>
            <div className="text-2xl font-bold">{dashboard.productVariants}</div>
            <p className="text-xs text-muted-foreground">+{dashboard.productVariantsInRange}</p>
          </CardContent>
        </Card>
        <Card>
          <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
            <CardTitle className="text-sm font-medium">Users</CardTitle>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              strokeLinecap="round"
              strokeLinejoin="round"
              strokeWidth="2"
              className="size-4 text-muted-foreground"
            >
              <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" />
              <circle cx="9" cy="7" r="4" />
              <path d="M22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75" />
            </svg>
          </CardHeader>
          <CardContent>
            <div className="text-2xl font-bold">{dashboard.users}</div>
            <p className="text-xs text-muted-foreground">+{dashboard.usersInRange}</p>
          </CardContent>
        </Card>
      </div>
    </div>
  )
}
